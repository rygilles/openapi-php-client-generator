{% if route.inPathParameters|length > 0 %}
		$path = '{{ route.path }}';

		$pathReplacements = [
{% for parameterName, phpCode in route.inPathParameters %}
			'{{ '{' ~ parameterName ~ '}' }}' => {{ phpCode|raw }},
{% endfor %}
		];

		$url = str_replace(array_keys($pathReplacements), array_values($pathReplacements), $path);
{% else %}
		$url = '{{ route.path }}';
{% endif %}
{% if route.inQueryParameters|length > 0 %}

		$queryParameters = [];

{% for queryParameter in route.inQueryParameters %}
{% if queryParameter.required %}
		$queryParameters['{{ queryParameter.name }}'] = {{ queryParameter.phpValue }};
{% else %}

		if (!is_null(${{ queryParameter.name }})) {
			$queryParameters['{{ queryParameter.name }}'] = {{ queryParameter.phpValue }};
		}
{% endif %}
{% endfor %}
{% endif %}

		$request = $this->apiClient->getHttpClient()->request('{{ route.httpMethod }}', $url{% if route.inQueryParameters|length > 0 %}, $queryParameters{% endif %});

		if ($request->getStatusCode() != {{ route.exceptedResponseCode }}) {
			throw new ApiException('Unexpected response HTTP code : ' . $request->getStatusCode() . ' instead of {{ route.exceptedResponseCode }}');
		}
{% if route.return is defined %}

		$requestBody = json_decode((string) $request->getBody(), true);

		$response = {{ route.responseMaker|raw }}

		return $response;
{% endif %}